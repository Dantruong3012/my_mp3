<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Music Playlist</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        body { background-color: #f0f2f5; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .music-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 30px;
            margin-top: 30px;
        }
        .audio-player {
            width: 100%;
            height: 40px;
            border-radius: 20px;
            outline: none;
        }
        .table-hover tbody tr:hover {
            background-color: #f8f9fa;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="music-card">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="fw-bold text-primary m-0"><i class="fas fa-music me-2"></i>My Playlist</h2>
            <a href="/music/application" class="btn btn-success"><i class="fas fa-upload me-2"></i>Upload Mới</a>
        </div>

        <form th:action="@{/view}" method="get" class="mb-4">
            <div class="input-group">
                <input type="text" class="form-control" name="keyWord"
                       th:value="${keyWord}"
                       placeholder="Nhập tên bài hát hoặc ca sĩ...">
                <button class="btn btn-primary" type="submit">
                    <i class="fas fa-search"></i> Tìm kiếm
                </button>
                <a th:if="${keyWord != null}" th:href="@{/view}" class="btn btn-secondary">Hủy</a>
            </div>
        </form>

        <div class="table-responsive">
            <table class="table table-hover align-middle">
                <thead class="table-light">
                <tr>
                    <th class="text-center">#</th>
                    <th>Tên bài hát</th>
                    <th>Ca sĩ</th>
                    <th style="width: 350px;">Nghe thử</th>
                    <th class="text-center">Hành động</th>
                </tr>
                </thead>
                <tbody>
                <tr th:if="${#lists.isEmpty(musicList)}">
                    <td colspan="5" class="text-center text-muted py-5">
                        <i class="fas fa-music fa-3x mb-3 d-block"></i>
                        Chưa có bài hát nào. Hãy upload ngay!
                    </td>
                </tr>

                <tr th:each="music, iterStat : ${musicList}">
                    <td class="text-center fw-bold text-secondary" th:text="${iterStat.count}">1</td>

                    <td class="fw-bold" th:text="${music.name}">Tên bài hát</td>

                    <td th:text="${music.artist}">Ca sĩ</td> <td>
                    <audio controls class="audio-player">
                        <source th:src="@{'/musicFile/' + ${music.musicPath}}" type="audio/mpeg">
                        Trình duyệt không hỗ trợ.
                    </audio>
                </td>

                    <td class="text-center">
                        <form th:action="@{/delete/{id}(id=${music.id})}" method="post"
                              onsubmit="return confirm('Bạn có chắc chắn muốn xóa bài này không?');">
                            <button type="submit" class="btn btn-outline-danger btn-sm rounded-pill px-3">
                                <i class="fas fa-trash-alt"></i> Xóa
                            </button>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="mt-3 text-end text-muted small">
            Tổng số bài hát: <span th:text="${#lists.size(musicList)}">0</span>
        </div>
    </div>
</div>

</body>
</html>